
import read
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score, confusion_matrix, precision_score, recall_score, f1_score
from sklearn.model_selection import GridSearchCV
from sklearn.metrics import classification_report


print ("Reading data ...")
x_all, y_all = read.read(LOAD_DATA=False)
x_train, x_test, y_train, y_test = train_test_split(x_all, y_all, test_size=0.3, random_state=42)
print (x_train.shape, y_train.shape)
print (x_test.shape, y_test.shape)

models = [RandomForestClassifier(),
          RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini',
                                max_depth=None, max_features='sqrt', max_leaf_nodes=None,
                                min_impurity_decrease=0.0, min_impurity_split=None,
                                min_samples_leaf=1, min_samples_split=2,
                                min_weight_fraction_leaf=0.0, n_estimators=1000, n_jobs=1,
                                oob_score=False, random_state=None, verbose=0,
                                warm_start=False)]
   
 
for model in models:
        print ("Fitting RF ...")
        model.fit(x_train, y_train)

        print ("Evaluating ...")
        y_pred = model.predict(x_test)

        print ("Accuracy is %f." % accuracy_score(y_test, y_pred))
        print (confusion_matrix(y_test, y_pred))
        print ("Precision score is %f." % precision_score(y_test, y_pred))
        print ("Recall score is %f." % recall_score(y_test, y_pred))
        print ("F1 score is %f." % f1_score(y_test, y_pred))
        print ("-----------------------------------")


